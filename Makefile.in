#
# Copyright (C) 2002 Christophe Kalt
#
# This file is part of shmux,
# see the LICENSE file for details on your rights.
#
# $Id: Makefile.in,v 1.2 2002-07-09 00:21:28 kalt Exp $
#

INSTALL	= @INSTALL@
prefix	= @prefix@
exec_prefix = @exec_prefix@
bindir	= @bindir@
mandir	= @mandir@

shmux:
	@(cd src && $(MAKE) shmux)

test: shmux
	@(test=`./src/shmux -sqtc 'echo $${SHMUX_TARGET}' sh:one 2>&1`; \
	  if [ "x$${test}" = "xone" ]; then \
		echo "Simple test succeeded... this doesn't mean much."; \
	  else \
		echo "Ugh, something's broken."; \
		echo "If you're using gcc, try to disable optimization"; \
		exit 1; \
	  fi)

install: shmux
	$(INSTALL) -d -m 0755 $(bindir)
	$(INSTALL) -m 755 src/shmux $(bindir)
	$(INSTALL) -d -m 0755 $(mandir)/man1
	$(INSTALL) -m 644 shmux.1 $(mandir)/man1
	@echo ; echo "Done!"

clean:
	@(cd src && $(MAKE) clean)

distclean:
	@(cd src && $(MAKE) distclean)
	/bin/rm -f Makefile config.* configure.lineno
	/bin/rm -rf autom4te.cache
