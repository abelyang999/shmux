#
# Copyright (C) 2002, 2003 Christophe Kalt
#
# This file is part of shmux,
# see the LICENSE file for details on your rights.
#
# $Id: Makefile.in,v 1.5 2003-03-27 00:55:43 kalt Exp $
#

INSTALL	= @INSTALL@
prefix	= @prefix@
exec_prefix = @exec_prefix@
bindir	= @bindir@
mandir	= @mandir@
sharedir= @datadir@/shmux

shmux:
	@(cd src && $(MAKE) shmux)

test: shmux
	@(test=`./src/shmux -bsqtc 'echo $${SHMUX_TARGET}' sh:one 2>&1`; \
	  if [ "x$${test}" = "xone" ]; then \
		echo "Simple test succeeded... this doesn't mean much."; \
	  else \
		echo "Ugh, something's broken."; \
		echo "If you're using gcc, try to disable optimization"; \
		exit 1; \
	  fi)

install: shmux
	$(INSTALL) -d -m 0755 $(bindir)
	$(INSTALL) -m 755 src/shmux $(bindir)
	$(INSTALL) -d -m 0755 $(mandir)/man1
	$(INSTALL) -m 644 shmux.1 $(mandir)/man1
	$(INSTALL) -d -m 0755 $(sharedir)
	$(INSTALL) -m 644 mcmd.sh $(sharedir)
	@echo ; echo "Done!"

clean:
	@(cd src && $(MAKE) clean)

distclean:
	@(cd src && $(MAKE) distclean)
	/bin/rm -f Makefile config.* configure.lineno
	/bin/rm -rf autom4te.cache
